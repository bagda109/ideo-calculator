<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nova Visual ‚Äî AI Video</title>
  <style>
    :root{
      --bg:#0b0d10;
      --card:#11151b;
      --card2:#0f1318;
      --text:#e9eef7;
      --muted:#9aa6b2;
      --line:#1e2630;
      --pill:#151b24;

      --accent:#b6ff2b;
      --pink:#ff2bd6;
      --shadow: 0 16px 55px rgba(0,0,0,.45);
      --r:18px;

      --modeGlow: rgba(182,255,43,.12);
      --modeGlow2: rgba(182,255,43,.06);
      --modeBorder: rgba(182,255,43,.25);
      --modeLabel: #eaffc7;
      --modeMuted: rgba(224,255,195,.78);
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(1200px 800px at 10% 0%, var(--modeGlow), transparent 55%),
        radial-gradient(900px 700px at 90% 10%, var(--modeGlow2), transparent 60%),
        var(--bg);
      color:var(--text);
      padding: 14px;
      line-height: 1.35;
      transition: 150ms ease;
    }
    body[data-mode="core"]{
      --modeGlow: rgba(255,43,214,.12);
      --modeGlow2: rgba(182,255,43,.08);
      --modeBorder: rgba(255,43,214,.22);
      --modeLabel: #dbe6f7;
      --modeMuted: #9aa6b2;
    }
    .wrap{ max-width: 560px; margin: 0 auto; padding-bottom: 96px; }

    .card{
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,0)) , var(--card);
      border-radius: 18px;
      box-shadow: var(--shadow);
      padding: 14px;
      margin-bottom: 12px;
    }

    .brandRow{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }
    .brand{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .brandName{
      font-size: 13px;
      font-weight: 1000;
      letter-spacing:.5px;
      text-transform: uppercase;
      color: var(--modeLabel);
    }
    .brandTag{
      font-size: 11px;
      color: var(--modeMuted);
      font-weight: 800;
      line-height: 1.45;
      max-width: 58ch;
    }
    h1{
      font-size: 20px;
      margin: 8px 0 0 0;
      line-height: 1.15;
      letter-spacing:.15px;
    }
    .sub{
      margin: 10px 0 0 0;
      font-size: 12px;
      color: var(--modeMuted);
      font-weight: 800;
      line-height: 1.45;
    }

    .seg{
      display:flex;
      gap:6px;
      padding:6px;
      border:1px solid var(--line);
      background: var(--pill);
      border-radius: 999px;
      flex-wrap:wrap;
      justify-content:space-between;
    }
    .seg label{ display:flex; align-items:center; cursor:pointer; user-select:none; flex:1; }
    .seg input{ position:absolute; opacity:0; pointer-events:none; }
    .seg span{
      width:100%;
      min-height: 48px;
      padding: 14px 16px;
      border-radius: 999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.02);
      color: var(--muted);
      font-size: 14px;
      font-weight: 1000;
      display:flex; align-items:center; justify-content:center;
      text-align:center;
      transition: 120ms ease;
    }
    .seg input:checked + span{
      border-color: rgba(182,255,43,.55);
      background: rgba(182,255,43,.18);
      color:#eaffc7;
      box-shadow: 0 0 0 3px rgba(182,255,43,.08);
    }
    body[data-mode="core"] .seg input:checked + span{
      border-color: rgba(255,43,214,.40);
      background: rgba(255,43,214,.14);
      color:#ffd1f3;
      box-shadow: 0 0 0 3px rgba(255,43,214,.08);
    }

    .sectionTitle{
      font-size: 13px;
      color: var(--modeLabel);
      font-weight: 1000;
      margin: 0 0 10px 0;
      letter-spacing:.15px;
    }
    .mini{
      font-size: 11px;
      color: var(--modeMuted);
      font-weight: 800;
      line-height: 1.45;
    }

    .entryGrid{ display:grid; gap:12px; }
    .entryCard{
      border:1px solid var(--line);
      border-radius: 18px;
      padding: 14px;
      background: rgba(255,255,255,.02);
    }
    .entryTop{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:10px;
      font-weight: 1100;
      letter-spacing:.1px;
    }
    .entryTop small{ color: var(--muted); font-weight: 900; font-size: 11px; }
    .entryList{
      margin: 10px 0 0 0;
      padding-left: 18px;
      color: #cfe0ff;
      opacity:.92;
      font-size: 12px;
      font-weight: 700;
      line-height: 1.5;
    }
    .entryPrice{
      margin-top: 12px;
      font-size: 24px;
      font-weight: 1200;
      letter-spacing:.2px;
      line-height: 1.05;
    }
    .entryPrice small{
      display:block;
      margin-top: 6px;
      font-size: 12px;
      font-weight: 850;
      color: var(--modeMuted);
    }

    .btn{
      width:100%;
      min-height: 56px;
      border:0;
      border-radius: 16px;
      background: linear-gradient(90deg, rgba(182,255,43,1), rgba(182,255,43,.78));
      color:#0b0d10;
      font-weight: 1100;
      font-size: 16px;
      letter-spacing:.15px;
      cursor:pointer;
      margin-top: 12px;
    }
    body[data-mode="core"] .btn{
      background: linear-gradient(90deg, rgba(255,43,214,1), rgba(255,43,214,.78));
    }
    .btn.secondary{
      background: rgba(255,255,255,.06);
      color: var(--text);
      border: 1px solid rgba(255,255,255,.08);
    }
    .btnRow{
      display:flex;
      gap:10px;
      margin-top: 12px;
    }
    .btnRow .btn{ margin-top: 0; min-height: 52px; font-size: 14px; }

    .result{
      border:1px solid var(--modeBorder);
      background: linear-gradient(180deg, rgba(182,255,43,.10), rgba(182,255,43,0));
      border-radius: 18px;
      padding: 14px;
    }
    body[data-mode="core"] .result{
      background: linear-gradient(180deg, rgba(255,43,214,.10), rgba(255,43,214,0));
    }
    .price{
      font-size: 30px;
      font-weight: 1200;
      letter-spacing:.2px;
      line-height: 1.05;
    }
    .price small{
      display:block;
      margin-top: 6px;
      font-size: 12px;
      font-weight: 850;
      color: var(--modeMuted);
    }
    .badges{ display:flex; gap:8px; flex-wrap:wrap; margin-top: 10px; }
    .badge{
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      padding: 7px 10px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 950;
      color: var(--muted);
    }
    .badge.ok{ border-color: rgba(182,255,43,.35); color:#eaffc7; }
    body[data-mode="core"] .badge.ok{ border-color: rgba(255,43,214,.35); color:#ffd1f3; }

    .listGrid{ display:grid; gap:10px; }
    .pickCard{
      border:1px solid var(--line);
      border-radius: 16px;
      padding: 14px;
      background: rgba(255,255,255,.02);
      cursor:pointer;
      transition:120ms ease;
      min-height: 58px;
    }
    .pickCard.active{
      border-color: rgba(255,43,214,.35);
      background: linear-gradient(180deg, rgba(255,43,214,.10), rgba(255,43,214,0));
      box-shadow: 0 0 0 3px rgba(255,43,214,.08);
    }
    body[data-mode="test"] .pickCard.active{
      border-color: rgba(182,255,43,.40);
      background: linear-gradient(180deg, rgba(182,255,43,.10), rgba(182,255,43,0));
      box-shadow: 0 0 0 3px rgba(182,255,43,.08);
    }
    .pickTop{
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:flex-start;
      font-weight: 1100;
    }
    .pickTop small{ color: var(--muted); font-weight: 900; font-size: 11px; }
    .pickDesc{ margin-top: 8px; color:#cfe0ff; opacity:.9; font-size: 12px; font-weight: 650; line-height: 1.45; }

    .qtyRow{ display:flex; gap:10px; align-items:center; justify-content:space-between; }
    .qty{ display:flex; gap:8px; align-items:center; }
    .qty button{
      min-height: 48px; min-width: 48px;
      border-radius: 14px;
      border:1px solid var(--line);
      background: transparent;
      color: var(--text);
      font-weight: 1200;
      font-size: 18px;
      cursor:pointer;
    }
    .qty input{
      width: 88px; min-height: 48px;
      border-radius: 14px;
      border:1px solid var(--line);
      background: var(--card2);
      color: var(--text);
      font-size: 16px;
      font-weight: 1100;
      text-align:center;
      outline:none;
    }

    .copy{
      margin-top: 10px;
      border-radius: 16px;
      border: 1px dashed rgba(182,255,43,.35);
      background: rgba(182,255,43,.05);
      padding: 12px;
      font-size: 12px;
      line-height: 1.45;
      color:#dfffb3;
      font-weight: 850;
      word-break: break-word;
    }
    body[data-mode="core"] .copy{
      border-color: rgba(255,43,214,.35);
      background: rgba(255,43,214,.05);
      color:#ffd1f3;
    }

    details{
      margin-top: 10px;
      border:1px solid var(--line);
      border-radius: 16px;
      background: rgba(255,255,255,.02);
      padding: 12px;
    }
    details summary{
      cursor:pointer;
      font-weight: 1000;
      color: var(--modeLabel);
      list-style:none;
    }
    details summary::-webkit-details-marker{ display:none; }
    details ul{
      margin:10px 0 0 0;
      padding-left: 18px;
      color: var(--modeMuted);
      font-size: 12px;
      line-height: 1.55;
      font-weight: 800;
    }

    .hidden{ display:none !important; }

    @media (min-width: 900px){
      body{ padding: 24px; }
      .wrap{ max-width: 760px; }
      h1{ font-size: 26px; }
      .entryPrice{ font-size: 28px; }
      .price{ font-size: 36px; }
    }
  </style>
</head>

<body data-mode="test">
<div class="wrap">

  <!-- HERO -->
  <div class="card" id="top">
    <div class="brandRow">
      <div class="brand">
        <div class="brandName">Nova Visual</div>
        <div class="brandTag">AI Video Studio ‚Ä¢ –ú—ã –ø—Ä–æ–¥–∞—ë–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∞ –Ω–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</div>
      </div>

      <div style="min-width: 260px; flex:1; max-width: 360px;">
        <div class="seg" id="modeSeg" aria-label="–†–µ–∂–∏–º">
          <label><input type="radio" name="mode" value="test" checked><span>‚óè –¢–µ—Å—Ç</span></label>
          <label><input type="radio" name="mode" value="core"><span>‚óã –ü—Ä–æ–¥–∞–∫—à–Ω</span></label>
        </div>
        <div class="mini" id="modeMini" style="margin-top:8px;">–¢–µ—Å—Ç ‚Äî —Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± —É–≤–∏–¥–µ—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∏ –ø–æ–¥—Ö–æ–¥.</div>
      </div>
    </div>

    <h1>–ü–æ—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å AI-—Ä–æ–ª–∏–∫–∞</h1>
    <p class="sub"><b>80% –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞—á–∏–Ω–∞—é—Ç —Å —Ç–µ—Å—Ç–∞</b> ‚Äî –æ–¥–∏–Ω –∫–æ—Ä–æ—Ç–∫–∏–π —Ä–æ–ª–∏–∫, —á—Ç–æ–±—ã –æ—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∏ –∫–æ–º—Ñ–æ—Ä—Ç —Ä–∞–±–æ—Ç—ã.</p>
  </div>

  <!-- ENTRY -->
  <div class="card" id="entryCard">
    <div class="sectionTitle">–° —á–µ–≥–æ –Ω–∞—á–∞—Ç—å</div>

    <div class="entryGrid">
      <div class="entryCard" id="testOffer">
        <div class="entryTop">üß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–æ–ª–∏–∫ <small>—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º</small></div>
        <ul class="entryList">
          <li>1 —Ä–æ–ª–∏–∫</li>
          <li>8‚Äì10 —Å–µ–∫—É–Ω–¥</li>
          <li>1 —Å—Ü–µ–Ω–∞</li>
          <li>–±–µ–∑ –ø—Ä–∞–≤–æ–∫</li>
        </ul>

        <div class="entryPrice" id="testPrice">2 900 ‚ÇΩ
          <small>—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞</small>
        </div>

        <button class="btn" id="testBtn">–°–¥–µ–ª–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–æ–ª–∏–∫</button>

        <div class="mini" style="margin-top:10px;">
          –ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∞ –ø—Ä–µ–¥–ª–æ–∂–∏–º –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ø—Ä–æ–¥–∞–∫—à–Ω–∞ –ø–æ–¥ –≤–∞—à—É –∑–∞–¥–∞—á—É.
        </div>
      </div>

      <div class="entryCard" id="coreOffer">
        <div class="entryTop">üé¨ –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–¥–∞–∫—à–Ω <small>–ø–æ—Å—á–∏—Ç–∞—Ç—å</small></div>
        <ul class="entryList">
          <li>–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å 10‚Äì60 —Å–µ–∫</li>
          <li>—É—Ä–æ–≤–Ω–∏: Light / Medium / Pro</li>
          <li>–ø–∞–∫–µ—Ç—ã –∏ –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω—ã</li>
        </ul>

        <button class="btn secondary" id="goCoreBtn">–ü–æ—Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ–¥–∞–∫—à–Ω</button>

        <div class="mini" style="margin-top:10px;">
          –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –ø–æ–Ω—è—Ç–Ω–∞ ‚Äî –ø–æ—Å—á–∏—Ç–∞–π—Ç–µ —Ü–µ–Ω—É ‚Äú–æ—Ç‚Äù –∏ –æ—Å—Ç–∞–≤—å—Ç–µ –∑–∞—è–≤–∫—É.
        </div>
      </div>
    </div>
  </div>

  <!-- CORE CALC -->
  <div class="card hidden" id="calcCard">
    <div class="sectionTitle">–°—Ç–æ–∏–º–æ—Å—Ç—å</div>

    <div class="result" id="resultCard">
      <div class="price" id="price">‚Äî</div>
      <div class="badges" id="badges"></div>
      <div class="mini" id="underPrice" style="margin-top:10px;">‚Äî</div>
    </div>

    <div style="height:12px"></div>

    <div class="sectionTitle">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</div>
    <div class="seg" id="durSeg">
      <label><input type="radio" name="dur" value="10" checked><span>10 —Å–µ–∫</span></label>
      <label><input type="radio" name="dur" value="15"><span>15 —Å–µ–∫</span></label>
      <label><input type="radio" name="dur" value="30"><span>30 —Å–µ–∫</span></label>
      <label><input type="radio" name="dur" value="60"><span>60 —Å–µ–∫</span></label>
    </div>

    <div style="height:14px"></div>

    <div class="sectionTitle">–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–¥–∞–∫—à–Ω–∞</div>
    <div class="listGrid" id="tierList">
      <div class="pickCard" data-tier="light">
        <div class="pickTop">‚ú® Light <small>–±—ã—Å—Ç—Ä–æ</small></div>
        <div class="pickDesc">–ü—Ä–æ—Å—Ç–∞—è —Å—Ü–µ–Ω–∞, –º–∏–Ω–∏–º—É–º –∏—Ç–µ—Ä–∞—Ü–∏–π. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–¥–∞—á.</div>
      </div>
      <div class="pickCard active" data-tier="medium">
        <div class="pickTop">‚öñÔ∏è Medium <small>–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ</small></div>
        <div class="pickDesc">–ë–∞–ª–∞–Ω—Å —Ü–µ–Ω–∞/–∫–∞—á–µ—Å—Ç–≤–æ. –û–±—ã—á–Ω–æ —ç—Ç–æ ‚Äú–∑–æ–ª–æ—Ç–∞—è —Å–µ—Ä–µ–¥–∏–Ω–∞‚Äù.</div>
      </div>
      <div class="pickCard" data-tier="pro">
        <div class="pickTop">üé• Pro <small>–ø—Ä–µ–º–∏—É–º</small></div>
        <div class="pickDesc">–ë–æ–ª—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –∏ ‚Äú–ø–æ–ø–∞–¥–∞–Ω–∏—è‚Äù. –°–ª–æ–∂–Ω–µ–µ ‚Äî –¥–æ—Ä–æ–∂–µ.</div>
      </div>
    </div>

    <div style="height:14px"></div>

    <div class="sectionTitle">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</div>
    <div class="qtyRow">
      <div class="mini">–†–æ–ª–∏–∫–æ–≤</div>
      <div class="qty">
        <button type="button" id="minus">‚àí</button>
        <input id="qty" type="number" min="1" step="1" value="1" />
        <button type="button" id="plus">+</button>
      </div>
    </div>

    <div style="height:14px"></div>

    <div class="sectionTitle">–§–æ—Ä–º–∞—Ç</div>
    <div class="seg" id="packSeg">
      <label><input type="radio" name="pack" value="one" checked><span>–†–∞–∑–æ–≤–æ</span></label>
      <label><input type="radio" name="pack" value="pack5"><span>–ü–∞–∫–µ—Ç 5</span></label>
      <label><input type="radio" name="pack" value="pack10"><span>–ü–∞–∫–µ—Ç 10</span></label>
    </div>

    <details>
      <summary>–û—Ç —á–µ–≥–æ –∑–∞–≤–∏—Å–∏—Ç —Ü–µ–Ω–∞</summary>
      <ul>
        <li>–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–æ–ª–∏–∫–∞</li>
        <li>—Å–ª–æ–∂–Ω–æ—Å—Ç—å —Å—Ü–µ–Ω—ã (–ø–µ—Ä—Å–æ–Ω–∞–∂–∏, —Ñ–æ–Ω, –¥–≤–∏–∂–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã)</li>
        <li>—Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤ —Å—Ç–∏–ª—å/—Ä–µ—Ñ–µ—Ä–µ–Ω—Å—ã</li>
        <li>–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –¥–æ —Ñ–∏–Ω–∞–ª–∞</li>
        <li>—Å—Ä–æ–∫–∏ (—Å—Ä–æ—á–Ω–æ = –¥–æ—Ä–æ–∂–µ)</li>
      </ul>
    </details>
  </div>

  <!-- CTA (core) -->
  <div class="card hidden" id="ctaCard">
    <button class="btn" id="ctaBtn">–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
    <div class="copy" id="copy">–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è Telegram: ‚Äî</div>

    <div class="btnRow">
      <button class="btn secondary" id="openTgBtn">–û—Ç–∫—Ä—ã—Ç—å Telegram</button>
      <button class="btn secondary" id="backTopBtn">–í –Ω–∞—á–∞–ª–æ</button>
    </div>

    <p class="mini" id="ctaNote" style="margin:10px 0 0 0;">
      –ù–∞–∂–º–∏—Ç–µ ‚Äú–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É‚Äù: —Ç–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä—É–µ—Ç—Å—è, –∑–∞—Ç–µ–º –æ—Ç–∫—Ä–æ–µ—Ç—Å—è Telegram.
    </p>
  </div>

</div>

<script>
  const TG_USERNAME = "zudov_bogdan";

  const LS = "novavisual_client_v23";

  // pricing logic (client-facing; internally you can change coefficients any time)
  const CONFIG = {
    test: { priceRub: 2900 },
    core: {
      // base price formula: perClip = max(minPerClip, dur * perSec + fixed)
      // then tier multiplier and package discount
      basePerSec: { light: 600, medium: 1050, pro: 1900 },
      fixedPerClip: { light: 2400, medium: 4300, pro: 7800 },
      minPerClip: { light: 7900, medium: 14900, pro: 29900 },
      discounts: { one: 0.00, pack5: 0.10, pack10: 0.20 },
    }
  };

  const $ = (id) => document.getElementById(id);
  const $$ = (sel) => Array.from(document.querySelectorAll(sel));
  const clamp = (n,a,b) => Math.max(a, Math.min(b,n));

  function fmtRub(n){ return "–æ—Ç " + Math.round(n).toLocaleString("ru-RU") + " ‚ÇΩ"; }
  function smoothTo(id){
    const el = $(id); if (!el) return;
    el.scrollIntoView({behavior:"smooth", block:"start"});
  }
  function tgLink(text){
    return `https://t.me/${TG_USERNAME}?text=${encodeURIComponent(text)}`;
  }
  async function copyToClipboard(text){
    try{
      await navigator.clipboard.writeText(text);
      return true;
    }catch{
      const ta = document.createElement("textarea");
      ta.value = text;
      document.body.appendChild(ta);
      ta.select();
      try{ document.execCommand("copy"); }catch{}
      document.body.removeChild(ta);
      return true;
    }
  }

  let state = {
    mode: "test",
    dur: 10,
    tier: "medium",
    qty: 1,
    pack: "one",
    lastMsg: "",
    lastPrice: "",
    coreUnlocked: false,
  };

  function load(){
    try{
      const raw = localStorage.getItem(LS);
      if (!raw) return;
      const s = JSON.parse(raw);
      if (s) state = {...state, ...s};
    }catch{}
  }
  function save(){
    try{ localStorage.setItem(LS, JSON.stringify(state)); }catch{}
  }

  function setMode(mode){
    state.mode = mode;
    document.body.setAttribute("data-mode", mode);
    $$('input[name="mode"]').forEach(i => i.checked = (i.value === mode));
    $("modeMini").textContent = mode === "test"
      ? "–¢–µ—Å—Ç ‚Äî —Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± —É–≤–∏–¥–µ—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∏ –ø–æ–¥—Ö–æ–¥."
      : "–ü—Ä–æ–¥–∞–∫—à–Ω ‚Äî —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ü–µ–Ω—É ‚Äú–æ—Ç‚Äù –∏ –æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É.";
    save();
  }

  function showCore(){
    state.coreUnlocked = true;
    $("calcCard").classList.remove("hidden");
    $("ctaCard").classList.remove("hidden");
    smoothTo("calcCard");
    calcCore();
    save();
  }
  function hideCore(){
    state.coreUnlocked = false;
    $("calcCard").classList.add("hidden");
    $("ctaCard").classList.add("hidden");
    save();
  }

  function getDur(){
    const r = document.querySelector('input[name="dur"]:checked');
    return r ? Number(r.value) : 10;
  }
  function getPack(){
    const r = document.querySelector('input[name="pack"]:checked');
    return r ? r.value : "one";
  }
  function selectTier(t){
    state.tier = t;
    $$("#tierList .pickCard").forEach(el=>{
      el.classList.toggle("active", el.dataset.tier === t);
    });
  }

  function renderBadges(){
    const b = $("badges");
    b.innerHTML = "";
    const ok = document.createElement("div");
    ok.className = "badge ok";
    ok.textContent = "–¶–µ–Ω–∞ ‚Äú–æ—Ç‚Äù";
    b.appendChild(ok);

    const t = document.createElement("div");
    t.className = "badge";
    const name = state.tier === "light" ? "Light" : (state.tier === "medium" ? "Medium" : "Pro");
    t.textContent = `–£—Ä–æ–≤–µ–Ω—å: ${name}`;
    b.appendChild(t);

    const p = document.createElement("div");
    p.className = "badge";
    p.textContent = "–ü–∞–∫–µ—Ç—ã –¥–∞—é—Ç —ç–∫–æ–Ω–æ–º–∏—é";
    b.appendChild(p);
  }

  function calcCore(){
    const dur = getDur();
    const pack = getPack();
    let qty = clamp(Math.round(Number($("qty").value) || 1), 1, 999);

    if (pack === "pack5" && qty < 5) qty = 5;
    if (pack === "pack10" && qty < 10) qty = 10;
    $("qty").value = qty;

    const tier = state.tier;
    const disc = CONFIG.core.discounts[pack] ?? 0;

    const raw = dur * CONFIG.core.basePerSec[tier] + CONFIG.core.fixedPerClip[tier];
    const per = Math.max(CONFIG.core.minPerClip[tier], raw);
    const perDisc = Math.round(per * (1 - disc));

    const priceFrom = fmtRub(perDisc);

    state.dur = dur;
    state.pack = pack;
    state.qty = qty;
    state.lastPrice = priceFrom;

    const tierName = tier === "light" ? "Light" : (tier === "medium" ? "Medium" : "Pro");
    const packName = pack === "one" ? "—Ä–∞–∑–æ–≤–æ" : (pack === "pack5" ? "–ø–∞–∫–µ—Ç 5" : "–ø–∞–∫–µ—Ç 10");

    const msg =
      `–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –•–æ—á—É AI-—Ä–æ–ª–∏–∫(–∏) –æ—Ç Nova Visual.\n` +
      `–ü–∞—Ä–∞–º–µ—Ç—Ä—ã: ${qty} —à—Ç, ${dur} —Å–µ–∫, —É—Ä–æ–≤–µ–Ω—å ${tierName}, —Ñ–æ—Ä–º–∞—Ç ${packName}.\n` +
      `–í –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–µ –≤–∏–∂—É —Ü–µ–Ω—É ${priceFrom}.\n` +
      `–î–∞–≤–∞–π—Ç–µ —É—Ç–æ—á–Ω–∏–º –∑–∞–¥–∞—á—É –∏ —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å.`;

    state.lastMsg = msg;

    $("price").innerHTML = `${priceFrom}<small>–∑–∞ —Ä–æ–ª–∏–∫</small>`;
    $("underPrice").textContent =
      "–¶–µ–Ω–∞ ‚Äú–æ—Ç‚Äù –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å—Ü–µ–Ω—ã –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏—Ç–µ—Ä–∞—Ü–∏–π. –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å ‚Äî –ø–æ—Å–ª–µ –∫–æ—Ä–æ—Ç–∫–æ–≥–æ –±—Ä–∏—Ñ–∞ –∏ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–æ–≤.";
    $("copy").textContent = "–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è Telegram: " + msg;

    renderBadges();
    save();
  }

  async function doTest(){
    const msg =
      `–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –•–æ—á—É —Ç–µ—Å—Ç–æ–≤—ã–π AI-—Ä–æ–ª–∏–∫ –æ—Ç Nova Visual.\n` +
      `–§–æ—Ä–º–∞—Ç: 1 —Ä–æ–ª–∏–∫ ‚Ä¢ 8‚Äì10 —Å–µ–∫ ‚Ä¢ 1 —Å—Ü–µ–Ω–∞ ‚Ä¢ –±–µ–∑ –ø—Ä–∞–≤–æ–∫.\n` +
      `–ì–æ—Ç–æ–≤(–∞) –ø—Ä–∏—Å–ª–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è —Ç–µ—Å—Ç–∞.`;
    await copyToClipboard(msg);

    const btn = $("testBtn");
    const old = btn.textContent;
    btn.textContent = "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ ‚úÖ –û—Ç–∫—Ä—ã–≤–∞—é Telegram‚Ä¶";
    setTimeout(()=> btn.textContent = old, 1400);

    window.open(tgLink(msg), "_blank");
  }

  async function doCoreCTA(){
    const msg = state.lastMsg || "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –•–æ—á—É AI-—Ä–æ–ª–∏–∫ –æ—Ç Nova Visual. –î–∞–≤–∞–π—Ç–µ –æ–±—Å—É–¥–∏–º –∑–∞–¥–∞—á—É.";
    await copyToClipboard(msg);

    const btn = $("ctaBtn");
    const old = btn.textContent;
    btn.textContent = "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ ‚úÖ –û—Ç–∫—Ä—ã–≤–∞—é Telegram‚Ä¶";
    setTimeout(()=> btn.textContent = old, 1400);

    window.open(tgLink(msg), "_blank");
  }

  // Events
  $$('input[name="mode"]').forEach(i => i.addEventListener("change", ()=>{
    setMode(i.value);
    hideCore();
    smoothTo("entryCard");
  }));

  $("testBtn").addEventListener("click", doTest);

  $("goCoreBtn").addEventListener("click", ()=>{
    setMode("core");
    showCore();
  });

  $$("#tierList .pickCard").forEach(el=>{
    el.addEventListener("click", ()=>{
      selectTier(el.dataset.tier);
      calcCore();
    });
  });

  $$('input[name="dur"]').forEach(i => i.addEventListener("change", calcCore));
  $$('input[name="pack"]').forEach(i => i.addEventListener("change", calcCore));

  $("minus").addEventListener("click", ()=>{
    $("qty").value = clamp((Number($("qty").value)||1)-1, 1, 999);
    calcCore();
  });
  $("plus").addEventListener("click", ()=>{
    $("qty").value = clamp((Number($("qty").value)||1)+1, 1, 999);
    calcCore();
  });
  $("qty").addEventListener("input", calcCore);

  $("ctaBtn").addEventListener("click", doCoreCTA);
  $("openTgBtn").addEventListener("click", ()=>{
    const msg = state.lastMsg || "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –•–æ—á—É AI-—Ä–æ–ª–∏–∫ –æ—Ç Nova Visual.";
    window.open(tgLink(msg), "_blank");
  });
  $("backTopBtn").addEventListener("click", ()=> smoothTo("top"));

  // Init
  load();

  // restore state
  setMode(state.mode || "test");

  $$('input[name="dur"]').forEach(i => i.checked = (Number(i.value) === (state.dur || 10)));
  $$('input[name="pack"]').forEach(i => i.checked = (i.value === (state.pack || "one")));
  $("qty").value = state.qty || 1;
  selectTier(state.tier || "medium");

  if (state.mode === "core" && state.coreUnlocked){
    $("calcCard").classList.remove("hidden");
    $("ctaCard").classList.remove("hidden");
    calcCore();
  } else {
    hideCore();
  }
</script>
</body>
</html>


